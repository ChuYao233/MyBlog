# 404 页面配置说明

本博客已创建自定义 404 页面（`src/pages/404.astro`），Astro 会在构建时将其生成为 `404.html`。要让 CDN 在访问不存在的路径时显示自定义的 404 页面，而不是 CDN 的默认 404 页面，需要根据您使用的 CDN 服务进行相应配置。

## 已创建的 404 页面

- **文件位置**: `src/pages/404.astro`
- **构建输出**: `dist/404.html`
- **访问路径**: `/404.html` 或 `/404/`

## CDN 配置方法

### EdgeOne（腾讯云）

1. 登录 [EdgeOne 控制台](https://console.cloud.tencent.com/edgeone)
2. 进入您的站点配置
3. 找到 **错误页面** 或 **自定义错误页面** 设置
4. 添加 404 错误页面规则：
   - **错误码**: `404`
   - **响应类型**: 重定向或返回自定义页面
   - **目标路径**: `/404.html` 或 `/404/`
5. 保存配置

**注意**: 如果 EdgeOne 支持自定义错误页面，通常需要：
- 将 404 错误重定向到 `/404.html`
- 或者配置返回自定义页面内容

### ESA（其他 CDN）

1. 登录您的 CDN 控制台
2. 进入域名管理或站点设置
3. 找到 **错误页面**、**自定义错误页面** 或 **错误码处理** 配置
4. 添加 404 规则：
   - **错误码**: `404`
   - **处理方式**: 重定向到 `/404.html` 或返回自定义页面
5. 保存配置

### Cloudflare Pages

Cloudflare Pages **自动支持** `404.html`，无需额外配置。只需确保构建输出中包含 `404.html` 文件即可。

### Cloudflare Workers（如果使用）

如果使用 Cloudflare Workers，需要在 `wrangler.json` 或 `wrangler.toml` 中配置：

```json
{
  "assets": {
    "directory": "./dist",
    "not_found_handling": "404-page"
  }
}
```

### 阿里云 CDN

1. 登录阿里云 CDN 控制台
2. 进入 **域名管理** → 选择域名 → **管理**
3. 进入 **缓存配置** → **自定义页面**
4. 点击 **添加**
5. 配置：
   - **错误码**: `404`
   - **自定义页面 URL**: `/404.html`
6. 保存配置

### 华为云 CDN

1. 登录华为云 CDN 控制台
2. 进入 **域名管理** → 选择域名 → **设置**
3. 进入 **高级配置** → **自定义错误页面配置**
4. 点击 **添加**
5. 配置：
   - **错误码**: `404`
   - **执行规则**: `Break`
   - **重定向目标**: `/404.html`
6. 保存配置

## 验证配置

配置完成后，可以通过以下方式验证：

1. 访问一个不存在的路径，例如：`https://yourdomain.com/non-existent-page`
2. 应该显示自定义的 404 页面，而不是 CDN 的默认 404 页面
3. 检查页面 URL 是否为 `/404.html` 或保持原始路径（取决于 CDN 配置）

## 注意事项

- 确保构建后的 `dist` 目录中包含 `404.html` 文件
- 某些 CDN 可能需要配置缓存规则，确保 404 页面不被缓存或缓存时间较短
- 如果配置后仍显示 CDN 的默认 404，请检查：
  - CDN 配置是否正确保存
  - CDN 缓存是否已清除
  - 构建输出中是否包含 `404.html`

## 测试本地构建

在本地测试 404 页面：

```bash
npm run build
npm run preview
```

然后访问 `http://localhost:4321/non-existent-page` 查看 404 页面效果。

